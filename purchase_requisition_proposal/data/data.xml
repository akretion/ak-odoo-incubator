<?xml version="1.0" encoding="UTF-8" ?>
<!-- Copyright (C) 2023 Akretion (<http://www.akretion.com>).
     @author KÃ©vin Roche <kevin.roche@akretion.com>
     License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl). -->
<odoo>
    <record id="call_for_proposals_type" model="purchase.requisition.type">
        <field name="name">Intercompany Call for Proposals</field>
        <field name="sequence">-1</field>
        <field name="line_copy">copy</field>
        <field name="quantity_copy">none</field>
        <field name="exclusive">proposals</field>
    </record>
    <record id="seq_purchase_requisition_proposal" model="ir.sequence">
        <field name="name">Purchase Requisition Proposal</field>
        <field name="code">purchase.requisition.proposal</field>
        <field name="prefix">PROP</field>
        <field name="padding">5</field>
        <field name="company_id" eval="False" />
    </record>
    <record id="seq_purchase_call" model="ir.sequence">
        <field name="name">Purchase Requisition Call </field>
        <field name="code">purchase.requisition.purchase.call</field>
        <field name="prefix">CALL</field>
        <field name="padding">5</field>
        <field name="company_id" eval="False" />
    </record>
    <record id="mail_template_requisition_proposal" model="mail.template">
        <field name="name">Requistion Call: Send by email</field>
        <field name="model_id" ref="purchase_requisition.model_purchase_requisition" />
        <field
            name="subject"
        >${object.company_id.name} Call for Proposals (Ref ${object.name or 'n/a' })</field>
        <field
            name="partner_to"
        >${','.join([str(partner.id) for partner in object.company_to_call_ids.partner_id]}</field>
        <field name="body_html" type="xml">
            <div style="margin: 0px; padding: 0px;">
                <p style="margin: 0px; padding: 0px; font-size: 13px;">
                    Dear collaborator,<br /><br />
                    <strong
                    >${object.company_id.name}</strong> have a new Call for Proposals: <strong
                    >${object.name}</strong>.<br />
                    The Agreement Deadline is <strong
                    >${format_date(object.date_end)}</strong>.
                    <br /><br />
                    Do not hesitate to contact us if you have any questions.
                    <br /><br />
                    <div style="margin:0px;padding: 0px;">
                        <table
                            style="color:#454748;font-size: 12px; border-collapse: collapse;"
                            width="100%"
                        >
                            <tbody>
                                <tr style="border-bottom:2px solid #dee2e6;">
                                    <td style="width:150px;"><strong
                                        >Products</strong></td>
                                    <td width="15%" align="center"><strong
                                        >Schedule Date</strong></td>
                                    <td width="15%" align="center"><strong
                                        >Quantity</strong></td>
                                    <td width="20%" align="right"><strong
                                        >Price</strong></td>
                                </tr>
                            </tbody>
                        </table>
                        % for line in object.line_ids:
                        <table
                            style="color:#454748;font-size: 12px; border-collapse: collapse;"
                            width="100%"
                        >
                            <tbody>
                                <tr
                                    style="${loop.cycle('background-color:#f2f2f2', 'background-color: #ffffff')}"
                                >
                                    <td
                                        align="left"
                                    >${line.product_id.display_name}</td>
                                    <td
                                        width="15%"
                                        align="center"
                                    >${format_date(line.schedule_date)} </td>
                                    <td
                                        width="15%"
                                        align="center"
                                    >${line.product_qty} ${line.product_uom_id.name}</td>
                                    <td width="20%" align="right"><strong>
                                            ${line.price_unit}
                                        </strong></td>
                                </tr>
                            </tbody>
                        </table>
                        % endfor
                        <br /><br />
                        Best regards,
                        % if user.signature:
                        <br />
                        ${user.signature | safe}
                        % endif
                    </div>
                </p>
            </div>
        </field>
        <field name="report_name">${(object.name or '').replace('/','-')}</field>
        <field name="lang">${object.company_id.lang}</field>
        <field name="auto_delete" eval="True" />
    </record>
</odoo>
